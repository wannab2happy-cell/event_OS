# Admin 사용 가이드

## 목차

1. [로그인](#1-로그인)
2. [대시보드](#2-대시보드)
3. [참가자 관리](#3-참가자-관리)
4. [브랜딩 설정](#4-브랜딩-설정)
5. [확정 메일 발송](#5-확정-메일-발송)
6. [Zero-Cost 가이드](#6-zero-cost-가이드)

## 1. 로그인

### Admin 계정 로그인

1. **로그인 페이지 접속**
   - URL: `https://[your-domain].vercel.app/admin/login`

2. **계정 정보 입력**
   - 이메일: Admin 계정 이메일
   - 비밀번호: Admin 계정 비밀번호

3. **로그인**
   - "로그인" 버튼 클릭
   - 로그인 성공 시 대시보드로 자동 리다이렉트

### Admin 계정 생성

Admin 계정은 Supabase 대시보드에서 생성해야 합니다:

1. **Supabase 대시보드 접속**
   - Authentication → Users

2. **새 사용자 추가**
   - "Add user" 버튼 클릭
   - 이메일과 비밀번호 입력
   - 이메일 확인 (필요시)

## 2. 대시보드

### 대시보드 주요 기능

대시보드(`/admin/dashboard`)에서 다음 정보를 확인할 수 있습니다:

#### 통계 카드

- **총 초대 참가자 수**: 전체 참가자 명단 기준
- **등록 완료 수**: 필수 정보 입력 완료한 참가자 수
- **현장 체크인 수**: QR 스캔 완료한 참가자 수
- **정보 완성도**: Completed 상태 참가자 비율

#### 최근 등록 참가자

- 가장 최근에 초대되거나 정보를 입력한 참가자 5명 표시
- 이름, 회사, 이메일, 상태 정보 표시
- "전체 참가자 보기" 링크로 전체 목록 이동

## 3. 참가자 관리

### 참가자 목록 조회

1. **참가자 목록 페이지 접속**
   - URL: `/admin/events/[eventId]/participants`
   - 또는 대시보드에서 "전체 참가자 보기" 클릭

2. **상태별 필터링**
   - 초대됨 (invited)
   - 등록 중 (registered)
   - 정보 완성 (completed)
   - 체크인 완료 (checked_in)

3. **참가자 정보 확인**
   - 이름, 회사, 이메일
   - 상태 배지
   - 항공/호텔 확정 상태 아이콘

### 참가자 상세 정보 및 편집

1. **참가자 선택**
   - 참가자 목록에서 특정 참가자 클릭
   - 또는 URL: `/admin/events/[eventId]/participants/[participantId]/edit`

2. **참가자 정보 확인**
   - 기본 정보 (이름, 이메일, 연락처, 소속)
   - 여권 정보
   - 항공 정보
   - 호텔 정보

3. **확정 정보 입력**
   - **항공 확정**
     - `발권 번호 (E-Ticket No)` 입력
     - `항공 확정` 체크박스 선택
   - **호텔 확정**
     - `확정 번호 (Confirmation No)` 입력
     - `호텔 확정` 체크박스 선택

4. **저장 및 메일 발송**
   - "저장" 버튼 클릭
   - 확정 정보가 저장되고 참가자에게 자동으로 확정 메일 발송

### 참가자 검색 (향후 기능)

- 참가자 목록에서 이름, 이메일, 회사명으로 검색 가능
- 필터링 옵션 확장 예정

## 4. 브랜딩 설정

### 이벤트 브랜딩 설정

1. **브랜딩 설정 페이지 접속**
   - URL: `/admin/events/[eventId]/branding`

2. **로고 이미지 업로드**
   - "로고 이미지" 섹션에서 이미지 선택
   - 권장 크기: 300KB 이하
   - 권장 형식: PNG, JPG, SVG

3. **KV 이미지 업로드**
   - "KV 이미지" 섹션에서 이미지 선택
   - 권장 크기: 300KB 이하
   - 권장 형식: PNG, JPG

4. **색상 설정**
   - Primary Color: 메인 색상 (예: #2563eb)
   - Secondary Color: 보조 색상 (예: #64748b)

5. **저장**
   - "저장" 버튼 클릭
   - 변경사항이 이벤트 랜딩 페이지에 반영됨

### 이미지 업로드 주의사항

- **파일 크기**: 300KB 이하 권장 (무료 티어 한도 고려)
- **파일 형식**: PNG, JPG, SVG 권장
- **이미지 개수**: 행사당 로고 1개, KV 이미지 1개 권장
- **Storage 한도**: Supabase 무료 티어는 1GB 제한

## 5. 확정 메일 발송

### 자동 메일 발송

참가자의 항공 또는 호텔 확정 정보를 입력하면 자동으로 확정 메일이 발송됩니다.

### 메일 발송 조건

- **항공 확정 메일**: `is_travel_confirmed`가 `true`로 변경될 때
- **호텔 확정 메일**: `is_hotel_confirmed`가 `true`로 변경될 때

### 메일 내용

확정 메일에는 다음 정보가 포함됩니다:

- 이벤트 이름
- 참가자 이름
- 발권 번호 (항공 확정 시)
- 확정 번호 (호텔 확정 시)
- QR PASS 페이지 링크
- 등록 정보 수정 링크

### 메일 발송 확인

1. **Resend 대시보드 확인**
   - https://resend.com/emails
   - 발송된 이메일 목록 확인
   - 발송 상태 확인

2. **참가자 확인**
   - 참가자 이메일 수신함 확인
   - 스팸 폴더 확인 (필요시)

### 메일 발송 실패 시

1. **환경 변수 확인**
   - `RESEND_API_KEY` 설정 확인
   - `RESEND_DOMAIN` 설정 확인

2. **Resend 한도 확인**
   - 무료 티어: 월 3,000통, 일 100통 제한
   - 한도 초과 시 유료 플랜 필요

3. **로그 확인**
   - Vercel 로그에서 에러 메시지 확인
   - Resend 대시보드에서 발송 실패 이유 확인

## 6. Zero-Cost 가이드

### 무료 티어 한도 확인

1. **Zero-Cost 가이드 페이지 접속**
   - URL: `/admin/settings/zero-cost`

2. **Supabase 무료 티어 한도**
   - Database Size: 최대 500MB
   - File Storage: 최대 1GB
   - Monthly Active Users: 50,000 MAU

3. **Resend 무료 티어 한도**
   - 월간 이메일: 3,000통
   - 일일 이메일: 100통

### 운영 주의사항

1. **이미지 관리**
   - 이미지 업로드 시 300KB 이하 파일만 허용
   - 동영상 업로드 금지
   - KV 이미지는 행사당 1개만 유지 권장

2. **로그 데이터 관리**
   - Mail logs, Access logs 주기적으로 백업 후 삭제
   - 불필요한 데이터 정기적으로 정리

3. **이메일 발송 관리**
   - 참가자 300명 기준, 1인당 평균 10통 발송 시 월간 한도 도달 가능
   - 중요한 메일만 발송하도록 관리

## 7. 문제 해결

### 로그인 실패

1. **계정 확인**
   - Supabase에서 Admin 계정이 올바르게 생성되었는지 확인
   - 이메일 확인이 완료되었는지 확인

2. **환경 변수 확인**
   - `NEXT_PUBLIC_SUPABASE_URL` 설정 확인
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY` 설정 확인

### 데이터 조회 실패

1. **RLS 정책 확인**
   - Supabase에서 RLS 정책이 올바르게 설정되었는지 확인
   - `SUPABASE_SERVICE_ROLE_KEY` 환경 변수 확인

2. **권한 확인**
   - Admin 계정이 올바른 권한을 가지고 있는지 확인

### 이미지 업로드 실패

1. **Storage 버킷 확인**
   - `event_assets` 버킷이 Public으로 설정되었는지 확인
   - 버킷 정책이 올바르게 설정되었는지 확인

2. **파일 크기 확인**
   - 300KB 이하 파일인지 확인
   - 파일 형식이 지원되는 형식인지 확인

## 8. 자주 묻는 질문 (FAQ)

### Q: 참가자 목록이 비어있어요.

A: Supabase에서 참가자 데이터가 올바르게 입력되었는지 확인하세요. RLS 정책이 올바르게 설정되었는지도 확인하세요.

### Q: 확정 메일이 발송되지 않아요.

A: `RESEND_API_KEY` 환경 변수가 올바르게 설정되었는지 확인하세요. Resend 한도를 초과하지 않았는지도 확인하세요.

### Q: 이미지가 표시되지 않아요.

A: Storage 버킷이 Public으로 설정되었는지 확인하세요. 이미지 URL이 올바른지도 확인하세요.

### Q: Admin 대시보드에 접근할 수 없어요.

A: Admin 계정으로 로그인했는지 확인하세요. `SUPABASE_SERVICE_ROLE_KEY` 환경 변수가 올바르게 설정되었는지도 확인하세요.

